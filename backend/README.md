### Prerequisites

1. You need to have Node.js v18.16.0 or more installed.
2. Download and install Postgres v15 (either through the installed or via the Postgres app) from [here](https://www.postgresql.org/download/).
3. You need to create an OpenAI account. You can do so [here](https://platform.openai.com/signup).

### Instructions on how to start the project locally  

1. Run `npm i` in the root folder.
2. Create a new `.env` file in the root folder and copy the contents from `.env.template` inside.
3. In the `.env` file, modify the `PORT` variable to match the desired port on where the backend should run.
4. In the `.env` file, modify the `DATABASE_URL` variable to match the URL of the database you desire to use. This requires you have Postgres installed (see the above section) and you have created a database and a schema (or you can use the default `public` one). A `DATABASE_URL` variable has the following structure: `postgresql://{USER}:{PASSWORD}@{HOST}:{PORT}/{DATABASE_NAME}?schema={SCHEMA_NAME}`.
5. In the `.env` file, modify the `JWT_SECRET` variable to match a desired string that will act as the secret with which all JWT tokens will be signed.
6. In the `.env` file, modify the `OPENAI_API_KEY` variable to match the API key generated by OpenAI for your account. You will need to register with OpenAI (see the above section). The API key will be found under the [API Keys section](https://platform.openai.com/account/api-keys).
7. Make sure you have the DB server running. Open a terminal in the root folder and run the following command: `npx prisma migrate dev`. This will run the migrations needed to set up the DB.
8. Run `npm start`.

### Instructions on how to build for production

Follow steps 1 - 8 from above, either directly on the production server, or configure them as part of a CI/CD integrated pipeline.

### Other mentions

In `common/constants/constants.js` is a list of CONSTANTS used throughout the code.

The most important ones:

1. `API_BASE_URL`: defines the relative base endpoint for the API.
2. `JWT_TOKEN_EXPIRY_TIME`: defines the expiry time of the JWT tokens.
3. `MAX_NUMBER_OF_SOURCES`: defines the maximum number of retrieved sources after doing vector embeddings comparisons in the DB. More sources are helpful, but can also reduce the response payload of GPT (the length of the answer) due to the token limitations imposed by OpenAI.
4. `MAX_DISTANCE`: defines the maximum degree of semantic similarity between the question asked and the sources that need to be retrieved. It is a float between 0 and 1. The smaller the number, the higher the semantic similarity. Go for low values if you are looking for more accurate/relevant sources or for higher values for more flexibility.
5. `MAX_FILE_SIZE`: defines the maximum file size when uploading documents (defaults to 10 MB, expressed in bytes).
